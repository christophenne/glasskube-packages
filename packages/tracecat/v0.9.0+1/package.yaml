# yaml-language-server: $schema=https://glasskube.dev/schemas/v1/package-manifest.json
name: tracecat
iconUrl: https://avatars.githubusercontent.com/u/137193901
shortDescription: The open source Tines / Splunk SOAR alternative
longDescription: |
  Tracecat is an open-source Tines / Splunk SOAR alternative for security engineers. We're building the features of Tines using enterprise-grade open-source tools.
defaultNamespace: tracecat
scope: Namespaced
references:
  - label: GitHub
    url: https://github.com/TracecatHQ/tracecat
  - label: Website
    url: https://tracecat.com/
dependencies:
  - name: cloudnative-pg
    version: 1.x.x
manifests:
  - url: ./tracecat.yaml
transitiveResources:
  - version: v1
    kind: Secret
    name: tracecat-db-app # TODO fix once https://github.com/glasskube/glasskube/pull/1211 is merged and released
valueDefinitions:
  tracecatDomain:
    type: text
    metadata:
      label: Tracecat domain
      description: |
        DNS name for the Tracecat Ingress
    constraints:
      pattern: ^([a-z0-9]([\-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([\-a-z0-9]*[a-z0-9])?)*)?$
      required: true
    targets:
      - patch:
          op: add
          path: /data/PUBLIC_APP_URL
        valueTemplate: |
          "https://{{ . }}"
        resource:
          apiGroup: v1
          kind: ConfigMap
          name: tracecat-config
      - patch:
          op: add
          path: /data/PUBLIC_API_URL
        valueTemplate: |
          "https://{{ . }}/api"
        resource:
          apiGroup: v1
          kind: ConfigMap
          name: tracecat-config
      - patch:
          op: add
          path: /spec/rules/0/host
        resource:
          apiGroup: networking.k8s.io/v1
          kind: Ingress
          name: tracecat-ingress
